<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jk51.modules.treat.mapper.WxAutoReplyMapper">
  <resultMap id="BaseResultMap" type="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <id column="site_id" jdbcType="INTEGER" property="siteId" />
    <result column="reply_type" jdbcType="INTEGER" property="replyType" />
    <result column="rule_name" jdbcType="VARCHAR" property="ruleName" />
    <result column="keywords" jdbcType="VARCHAR" property="keywords" />
    <result column="del_tag" jdbcType="INTEGER" property="delTag" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="reply_content" jdbcType="LONGVARCHAR" property="replyContent" />
    <result column="reply_content_type" jdbcType="INTEGER" property="replyContentType" />
    <result column="on_off" jdbcType="INTEGER" property="onOff" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, site_id, reply_type, rule_name, keywords, del_tag, create_time, update_time,reply_content_type,on_off
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    reply_content
  </sql>
  <select id="selectByPrimaryKey" parameterType="map" resultMap="ResultMapWithBLOBs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from b_wx_autoreply
    where id = #{id,jdbcType=INTEGER}
      and site_id = #{siteId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from b_wx_autoreply
    where id = #{id,jdbcType=INTEGER}
      and site_id = #{siteId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.jk51.model.treat.WxAutoReply">
    insert into b_wx_autoreply (id, site_id, reply_type, rule_name, keywords, del_tag,
      create_time, update_time, reply_content,reply_content_type
      )
    values (#{id}, #{siteId}, #{replyType}, #{ruleName}, #{keywords}, #{delTag},
      #{createTime}, #{updateTime}, #{replyContent},#{replyContentType}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into b_wx_autoreply
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="siteId != null">
        site_id,
      </if>
      <if test="replyType != null">
        reply_type,
      </if>
      <if test="ruleName != null">
        rule_name,
      </if>
      <if test="keywords != null">
        keywords,
      </if>
      <if test="delTag != null">
        del_tag,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="updateTime != null">
        update_time,
      </if>
      <if test="replyContent != null">
        reply_content,
      </if>
      <if test="replyContentType != null">
        reply_content_type,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="siteId != null">
        #{siteId,jdbcType=INTEGER},
      </if>
      <if test="replyType != null">
        #{replyType,jdbcType=INTEGER},
      </if>
      <if test="ruleName != null">
        #{ruleName,jdbcType=VARCHAR},
      </if>
      <if test="keywords != null">
        #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="delTag != null">
        #{delTag,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="replyContent != null">
        #{replyContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="replyContentType != null">
        #{replyContentType,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update b_wx_autoreply
    <set>
      <if test="replyType != null">
        reply_type = #{replyType,jdbcType=INTEGER},
      </if>
      <if test="ruleName != null">
        rule_name = #{ruleName,jdbcType=VARCHAR},
      </if>
      <if test="keywords != null">
        keywords = #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="delTag != null">
        del_tag = #{delTag,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="replyContent != null">
        reply_content = #{replyContent,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
      and site_id = #{siteId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update b_wx_autoreply
    set reply_type = #{replyType,jdbcType=INTEGER},
      rule_name = #{ruleName,jdbcType=VARCHAR},
      keywords = #{keywords,jdbcType=VARCHAR},
      del_tag = #{delTag,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      reply_content = #{replyContent,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=INTEGER}
      and site_id = #{siteId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update b_wx_autoreply
    set reply_type = #{replyType,jdbcType=INTEGER},
      rule_name = #{ruleName,jdbcType=VARCHAR},
      keywords = #{keywords,jdbcType=VARCHAR},
      del_tag = #{delTag,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_time = #{updateTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
      and site_id = #{siteId,jdbcType=INTEGER}
  </update>

  <!--一键启动-->
  <!--<update id="turnOnOff">-->
    <!--UPDATE b_wx_autoreply SET on_off=#{onOff} WHERE site_id=#{siteId} AND del_tag=1-->
  <!--</update>-->

  <!-- 更新关注回复的信息 -->
  <update id="updateAttention" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update b_wx_autoreply
    <set>
      <if test="replyType != null">
        reply_type = #{replyType,jdbcType=INTEGER},
      </if>
      <if test="ruleName != null">
        rule_name = #{ruleName,jdbcType=VARCHAR},
      </if>
      <if test="keywords != null">
        keywords = #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="delTag != null">
        del_tag = #{delTag,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="replyContent != null">
        reply_content = #{replyContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="replyContentType != null">
        reply_content_type = #{replyContentType},
      </if>
    </set>
    where site_id = #{siteId,jdbcType=INTEGER}
    and reply_type = #{replyType,jdbcType=INTEGER}
    and del_tag = 1
  </update>


  <!-- 更新默认回复的信息 -->
  <update id="updateDefaultReply" parameterType="com.jk51.model.treat.WxAutoReply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update b_wx_autoreply
    <set>
      <if test="replyType != null">
        reply_type = #{replyType,jdbcType=INTEGER},
      </if>
      <if test="ruleName != null">
        rule_name = #{ruleName,jdbcType=VARCHAR},
      </if>
      <if test="keywords != null">
        keywords = #{keywords,jdbcType=VARCHAR},
      </if>
      <if test="delTag != null">
        del_tag = #{delTag,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="replyContent != null">
        reply_content = #{replyContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="replyContentType != null">
        reply_content_type = #{replyContentType},
      </if>
    </set>
    where site_id = #{siteId,jdbcType=INTEGER}
    and reply_type = #{replyType,jdbcType=INTEGER}
    and del_tag = 1
  </update>

  <!-- 获取关注回复的信息-->
  <select id="selectByAttention" resultMap="ResultMapWithBLOBs">
    select
    *
    from b_wx_autoreply
    where
    reply_type = #{replyType}
    and site_id = #{siteId}
    and del_tag = 1
    <!--<if test="isdel != 1">
      AND on_off=0
    </if>-->

  </select>

  <!-- 获取默认的自动回复的信息-->
  <select id="defaultReply" resultMap="ResultMapWithBLOBs">
    select
    *
    from b_wx_autoreply
    where
    reply_type = #{replyType}
    and site_id = #{siteId}
    and del_tag = 1
    <!--<if test="isdel != 1">-->
      <!--AND on_off=0-->
    <!--</if>-->
  </select>

  <!-- 获取所有的关键字关注回复的信息-->
  <select id="getImportWordList" resultMap="ResultMapWithBLOBs">
    select
    *
    from b_wx_autoreply
    where
    reply_type = #{replyType}
    and site_id = #{siteId}
    and del_tag = 1 /*AND on_off=0*/
    ORDER BY create_time DESC
  </select>

</mapper>

        <!--<?xml version="1.0" encoding="UTF-8" ?>-->
        <!--<!DOCTYPE mapper-->
                <!--PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"-->
                <!--"http://mybatis.org/dtd/mybatis-3-mapper.dtd">-->

<!--<mapper namespace="com.jk51.modules.merchant.persistence.AutoReplyMapper">-->
<!--<resultMap id="AutoReplyMap" type="com.jk51.model.merchant.AutoReply">-->
  <!--<id column="site_id" property="siteId" />-->
  <!--<result column="reply_type"  property="replyType" />-->
  <!--<result column="rule_name" property="ruleName" />-->
  <!--<result column="reply_content" property="replyContent" />-->
  <!--<result column="del_tag" property="delTag" />-->
  <!--<result column="create_time" property="createTime" />-->
  <!--<result column="update_time" property="updateTime" />-->
<!--</resultMap>-->
<!--<select id="getReplyBySiteId" resultMap="AutoReplyMap">-->
  <!--select * from b_wx_autoreply WHERE site_id=#{0} and del_tag=1 and reply_type=#{1}-->
<!--</select>-->
<!--<select id="getKeywordReplyBySiteId" resultMap="AutoReplyMap">  /*关键字查询*/-->
  <!--select * from b_wx_autoreply WHERE #{2} like concat('%', keywords, '%') and site_id=#{0} and del_tag=1 and reply_type=#{1};-->
<!--</select>-->
<!--<insert id="addReply" parameterType="com.jk51.model.merchant.Meta">-->
  <!--insert into b_meta(site_id,reply_type,rule_name,reply_content,del_tag,create_time) VALUES(#{siteId},#{replyType},#{ruleName},#{replyContent},#{delTag},CURRENT_TIMESTAMP())-->
<!--</insert>-->
<!--<update id="updateReply">-->
  <!--UPDATE b_wx_autoreply set del_tag=0,update_time=CURRENT_TIMESTAMP() where site_id=#{0} and reply_type=#{1}-->
<!--</update>-->
<!--</mapper>-->
